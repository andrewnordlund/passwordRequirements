<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta content="width=device-width,initial-scale=1" name="viewport">
		<title>Password Requirements Test Page</title>
		<link rel="Stylesheet" type="text/css" href="pwReqTest.css">
	</head>
	<body>
		<header>
		<h1>Password Requirements Test Page</h1>
		</header>
		<div id="mainContent">
			<div class="fieldHolder">
				<label for="pword1">Password:</label>
				<input name="pword1" id="pword1" aria-describedby="passDesc 8chars lowerCase upperCase specialChar digit match" type="password" autocomplete="new-password">
			</div>
			<div class="fieldHolder">
				<label for="pword2">Confirm Password:</label>
				<input name="pword2" id="pword2" type="password" autocomplete="new-password" aria-describedby="match">
			</div>
			<div id="passwordRequirements">
				<p id="passDesc">Your password must contain at least:</p>
				<ul>
					<li id="8chars">8 characters (<span class="unmet">Unmet</span>)</li>
					<li id="lowerCase">1 Lowercase letter (<span class="unmet">Unmet</span>)</li>
					<li id="upperCase">1 Uppercase letter (<span class="unmet">Unmet</span>)</li>
					<li id="specialChar">1 Special character (<span class="unmet">Unmet</span>)</li>
					<li id="digit">1 digit (<span class="unmet">Unmet</span>)</li>
					<li id="match">Passwords must match (<span class="unmet">Unmet</span>)</li>
				</ul>
			</div>
			<input value="Submit" id="submitBtn" type="button">
			
		</div>
		<div>
			<h2>Notes</h2>
			<p>The important parts of this widget are:</p>
			<ul>
				<li>Only the first password field references the list of requirements using <code>aria-describedby</code></li>
				<li>“Met” and “Unmet” only change when the criteria becomes met, or unmet.</li>
				<li>Each list item is like:  <code>&lt;li aria-live=”polite” artia-atomic=”true”&gt;</code>.  <code>aria-live=”polite”</code> makes a screen reader read out the contents when there’s a change, and <code>aria-atomic=”true”</code> makes the screen reader read out the whole line, not just “met” or “unmet”.  Note that each list item needs to be its own live region.  If the whole widget is a live region, then the whole list gets read out whenever there’s a change.  You don’t want that.</li>
			</ul>
		</div>
		<section>
			<h2>Screen Reader results</h2>
			<section>
				<h3>Windows:</h3>
				<section>
					<h4>NVDA 2022.1</h4>
					<dl>
						<dt>Firefox 100</dt>
						<dd>When focus lands on the password field, all requirements are read as they should be. Then as I type a password when a met/unmet changes, the entire set of password requirements are read out again followed by the requirement whose status had changed. (I'm guessing it has something to do with <code>aria-describedby</code>.</dd>
						<dt>Edge 102</dt>
						<dd>When focus lands on the password field, all requirements are read as they should be. Then as I type a password when a met/unmet changes, the entire set of password requirements are read out again followed by the requirement whose status had changed.</dd>
						<dt>Chrome 101</dt>
						<dd>When focus lands on the password field, all requirements are read as they should be. Then as I type a password when a met/unmet changes, the entire set of password requirements are read out again followed by the requirement whose status had changed.</dd>
						<dt>Internet Explorer 11</dt>
						<dd>When focus lands on the password field, all requirements are read as they should be. Then as I type a password when a met/unmet changes, the entire set of password requirements are read out again followed by the requirement whose status had changed.</dd>
					</dl>
				</section>
				<section>
					<h4>JAWS 2021</h4>
					<dl>
						<dt>Firefox 100</dt>
						<dd>When focus lands on the password field, all requirements are read as they should be. Then as I type a password when a met/unmet changes, the entire set of password requirements are read out again followed by the requirement whose status had changed. (I'm guessing it has something to do with <code>aria-describedby</code>.</dd>
						<dt>Edge 102</dt>
						<dd>When focus lands on the password field, all requirements are read as they should be. Then as I type a password when a met/unmet changes, the entire set of password requirements are read out again followed by the requirement whose status had changed.</dd>
						<dt>Chrome 101</dt>
						<dd>When focus lands on the password field, all requirements are read as they should be. Then as I type a password when a met/unmet changes, the entire set of password requirements are read out again followed by the requirement whose status had changed.</dd>
						<dt>Internet Explorer 11</dt>
						<dd>When focus lands on the password field, all requirements are read as they should be. Then as I type a password when a met/unmet changes, the entire set of password requirements are read out again followed by the requirement whose status had changed.</dd>
					</dl>
				<section>
				<section>
					<h4>Narrator</h4>
					<dl>
						<dt>Firefox 100</dt>
						<dd>Does not read out the requirements when focus lands on the password input.  It should.  Then as you type, it does not read out the criteria as they're met/unmet. Total failure.</dd>
						<dt>Edge 102</dt>
						<dd>Does not read out the requirements when focus lands on the password input.  It should.  Then as you type, it does not read out the criteria as they're met/unmet.</dd>
						<dt>Chrome 101</dt>
						<dd>Does not read out the requirements when focus lands on the password input.  It should.  Then as you type, it does not read out the criteria as they're met/unmet.</dd>
						<dt>Internet Explorer 11</dt>
						<dd>Does not read out the requirements when focus lands on the password input.  It should.  Then as you type, it does not read out the criteria as they're met/unmet.</dd>
					</dl>
				<section>
			</section>
			<section>
				<h3>iOS with VoiceOver</h3>
				<section>
					<h4>iOS v14</h4>
					<dl>
						<dt>Sarafi, Firefox, and Chrome</dt>
						<dd>When focusing on the Password field, VO reads all requirements as it should.  But then as a password is typed, the changes are not announced.</dd>
					</dl>
				</section>
			</section>
			<section>
				<h3>Mac OS X with VoiceOver</h3>
				<section>
					<h4>Mac OS X 10.15.7 (Catalina)</h4>
					<dl>
						<dt>Sarafi, Firefox 101, and Chrome</dt>
						<dd>When focusing on the Password field, VO reads all requirements as it should.  But then as a password is typed, the changes are not announced.</dd>
					</dl>
				</section>	
			</section>

			<h3>Conclusion</h3>
			<p>In Windows it seems that whenever <em>one</em> thing changes that describes an input, all of that input's descriptors are read out again.  And on Apple systems, it's not the case.  This could be a nightmare.  The only good way I can think of doing this is having a live region that only lists what's changed, and after 1 keystroke, remove the <code>aria-describedby</code> from the input, then re-attach it on blur.</p>
			<p>UPDATE <time>2022-06-09</time>:  I think I have finished a <a href="pwReqTest-3.html">working example</a>.</p>
			<h3>Recommendations</h3>
			<ol>
				<li>It would be good to put the password requirements before the password fields rather than after.</li>
				<li>There is no good, simple way to do this.</li>
			</ol>
		</section>
		<footer>
			<p>Here is <a href="#">some random footer link</a>.</p>
			<script src="pwReqTest.js"></script>
		</footer>
	

</body></html>
